<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:125%/1.45 'Quattrocento Sans',sans-serif;box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.8);font-family:'Quattrocento Sans',sans-serif;font-weight:400;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;color:hsla(0,0%,0%,0.9);font-family:'Work Sans',sans-serif;font-weight:600;text-rendering:optimizeLegibility;font-size:2rem;line-height:1.1;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;color:hsla(0,0%,0%,0.9);font-family:'Work Sans',sans-serif;font-weight:600;text-rendering:optimizeLegibility;font-size:1.51572rem;line-height:1.1;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;color:hsla(0,0%,0%,0.9);font-family:'Work Sans',sans-serif;font-weight:600;text-rendering:optimizeLegibility;font-size:1.31951rem;line-height:1.1;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;color:hsla(0,0%,0%,0.9);font-family:'Work Sans',sans-serif;font-weight:600;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;color:hsla(0,0%,0%,0.9);font-family:'Work Sans',sans-serif;font-weight:600;text-rendering:optimizeLegibility;font-size:0.87055rem;line-height:1.1;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;color:hsla(0,0%,0%,0.9);font-family:'Work Sans',sans-serif;font-weight:600;text-rendering:optimizeLegibility;font-size:0.81225rem;line-height:1.1;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}ul{margin-left:1.45rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;list-style-position:outside;list-style-image:none;}ol{margin-left:1.45rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;font-size:0.85rem;line-height:1.45rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;font-size:1rem;line-height:1.45rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}blockquote{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0.90625rem;padding-right:0;padding-top:0;margin-bottom:1.45rem;font-size:1.1487rem;line-height:1.45rem;border-left:0.54375rem solid #3ab159;color:hsla(0,0%,0%,0.65);font-style:italic;}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.45rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}b{font-weight:700;}strong{font-weight:700;}dt{font-weight:700;}th{font-weight:700;}li{margin-bottom:calc(1.45rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.45rem;margin-bottom:calc(1.45rem / 2);margin-top:calc(1.45rem / 2);}li > ul{margin-left:1.45rem;margin-bottom:calc(1.45rem / 2);margin-top:calc(1.45rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(1.45rem / 2);}code{font-size:0.85rem;line-height:1.45rem;}kbd{font-size:0.85rem;line-height:1.45rem;}samp{font-size:0.85rem;line-height:1.45rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:0.96667rem;padding-right:0.96667rem;padding-top:0.725rem;padding-bottom:calc(0.725rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}a{color:#3ab159;text-decoration:none;text-shadow:none;background-image:none;}a:hover,a:active{text-shadow:none;background-image:none;}h1,h2,h3,h4,h5,h6{margin-top:2.175rem;margin-bottom:0.725rem;}blockquote > :last-child{margin-bottom:0;}blockquote cite{font-size:1rem;line-height:1.45rem;color:hsla(0,0%,0%,0.8);font-style:normal;font-weight:400;}blockquote cite:before{content:"— ";}@media only screen and (max-width:480px){html{font-size:106.25%;line-height:24.65px;}blockquote{border-left:0.27187rem solid #3ab159;color:hsla(0,0%,0%,0.59);padding-left:0.81563rem;font-style:italic;margin-left:-1.0875rem;margin-right:0;}}body,h1,h2,h3,h4,h5,h6,blockquote{color:#dfdfdf;}a:hover,a:focus{color:#61c57b;}</style><style data-href="/styles.f6749d95223b6ed09955.css">@font-face{font-family:Work Sans;font-style:normal;font-display:swap;font-weight:100;src:local("Work Sans Thin "),local("Work Sans-Thin"),url(/static/work-sans-latin-100-d8bc5d52d7005051a565bac5523f5d14.woff2) format("woff2"),url(/static/work-sans-latin-100-d966ba231acd7917dfc6f80ba1d0248c.woff) format("woff")}@font-face{font-family:Work Sans;font-style:italic;font-display:swap;font-weight:100;src:local("Work Sans Thin italic"),local("Work Sans-Thinitalic"),url(/static/work-sans-latin-100italic-7ede1fbc90e7ec492cd766b2430db441.woff2) format("woff2"),url(/static/work-sans-latin-100italic-b4886cd9567531e087c07e07c17d0af7.woff) format("woff")}@font-face{font-family:Work Sans;font-style:normal;font-display:swap;font-weight:200;src:local("Work Sans Extra Light "),local("Work Sans-Extra Light"),url(/static/work-sans-latin-200-da4e27015201c3105a83a27445895109.woff2) format("woff2"),url(/static/work-sans-latin-200-aa089a40cbb70b550024140c5da72bfe.woff) format("woff")}@font-face{font-family:Work Sans;font-style:italic;font-display:swap;font-weight:200;src:local("Work Sans Extra Light italic"),local("Work Sans-Extra Lightitalic"),url(/static/work-sans-latin-200italic-ff3efa5ab8e01b38a12ba589053f53f8.woff2) format("woff2"),url(/static/work-sans-latin-200italic-aa392bfbf1f1166258d6bfb59c0dc97a.woff) format("woff")}@font-face{font-family:Work Sans;font-style:normal;font-display:swap;font-weight:300;src:local("Work Sans Light "),local("Work Sans-Light"),url(/static/work-sans-latin-300-7cb91330ad4f9c20b7e2f28cc38f4195.woff2) format("woff2"),url(/static/work-sans-latin-300-e38aab4a1896cb400a1cf23d8c267858.woff) format("woff")}@font-face{font-family:Work Sans;font-style:italic;font-display:swap;font-weight:300;src:local("Work Sans Light italic"),local("Work Sans-Lightitalic"),url(/static/work-sans-latin-300italic-7005e1cda849b493d4b3c7a62c276759.woff2) format("woff2"),url(/static/work-sans-latin-300italic-7e79c1083676152144233b377e14da39.woff) format("woff")}@font-face{font-family:Work Sans;font-style:normal;font-display:swap;font-weight:400;src:local("Work Sans Regular "),local("Work Sans-Regular"),url(/static/work-sans-latin-400-e11127cd89b44da3216788e512a75dec.woff2) format("woff2"),url(/static/work-sans-latin-400-4f2ef2ad4e8b70e6493edf9a6e07a244.woff) format("woff")}@font-face{font-family:Work Sans;font-style:italic;font-display:swap;font-weight:400;src:local("Work Sans Regular italic"),local("Work Sans-Regularitalic"),url(/static/work-sans-latin-400italic-48f71e13c19d817cd48757c9276275cf.woff2) format("woff2"),url(/static/work-sans-latin-400italic-c78716ee823b659be568c99b5745d8e5.woff) format("woff")}@font-face{font-family:Work Sans;font-style:normal;font-display:swap;font-weight:500;src:local("Work Sans Medium "),local("Work Sans-Medium"),url(/static/work-sans-latin-500-e74cfb942ed6ab575a8125556d9977c2.woff2) format("woff2"),url(/static/work-sans-latin-500-8f894bfd2c1fd95a8518bcd1b9ce3e50.woff) format("woff")}@font-face{font-family:Work Sans;font-style:italic;font-display:swap;font-weight:500;src:local("Work Sans Medium italic"),local("Work Sans-Mediumitalic"),url(/static/work-sans-latin-500italic-63ac07cced455a858cc99d3812bfdbae.woff2) format("woff2"),url(/static/work-sans-latin-500italic-20f3447e739481f8daca006f14b7f4fa.woff) format("woff")}@font-face{font-family:Work Sans;font-style:normal;font-display:swap;font-weight:600;src:local("Work Sans SemiBold "),local("Work Sans-SemiBold"),url(/static/work-sans-latin-600-571740e246bab6d911558bdcfba37b87.woff2) format("woff2"),url(/static/work-sans-latin-600-6826bd04bc7f84d6f95a99a157499539.woff) format("woff")}@font-face{font-family:Work Sans;font-style:italic;font-display:swap;font-weight:600;src:local("Work Sans SemiBold italic"),local("Work Sans-SemiBolditalic"),url(/static/work-sans-latin-600italic-1244eb7f84cd26ca14ecfdc0e2387558.woff2) format("woff2"),url(/static/work-sans-latin-600italic-5fd626048d0ba2af5859861daeafcc41.woff) format("woff")}@font-face{font-family:Work Sans;font-style:normal;font-display:swap;font-weight:700;src:local("Work Sans Bold "),local("Work Sans-Bold"),url(/static/work-sans-latin-700-cdfda5e0329594d3abb19e225e6c2bc1.woff2) format("woff2"),url(/static/work-sans-latin-700-8a303ac06064e1d28e7aad9666c3df13.woff) format("woff")}@font-face{font-family:Work Sans;font-style:italic;font-display:swap;font-weight:700;src:local("Work Sans Bold italic"),local("Work Sans-Bolditalic"),url(/static/work-sans-latin-700italic-77c108167621cb18d3a445af1819f8b2.woff2) format("woff2"),url(/static/work-sans-latin-700italic-097dfec6025ca58f1d4d7238dfc5e80a.woff) format("woff")}@font-face{font-family:Work Sans;font-style:normal;font-display:swap;font-weight:800;src:local("Work Sans ExtraBold "),local("Work Sans-ExtraBold"),url(/static/work-sans-latin-800-45d74d0fec9f03eaa3a8837709aaf8d9.woff2) format("woff2"),url(/static/work-sans-latin-800-ca52f124e68ffb2ddc2d4630903d8329.woff) format("woff")}@font-face{font-family:Work Sans;font-style:italic;font-display:swap;font-weight:800;src:local("Work Sans ExtraBold italic"),local("Work Sans-ExtraBolditalic"),url(/static/work-sans-latin-800italic-ff84239b8ec4bb7247969ad811d8d596.woff2) format("woff2"),url(/static/work-sans-latin-800italic-dc3eb565004af4c0c469861f323b8ac3.woff) format("woff")}@font-face{font-family:Work Sans;font-style:normal;font-display:swap;font-weight:900;src:local("Work Sans Black "),local("Work Sans-Black"),url(/static/work-sans-latin-900-40dbe2076ed31bb002403b788895f3c0.woff2) format("woff2"),url(/static/work-sans-latin-900-1d411540426e8134586e134625bd3217.woff) format("woff")}@font-face{font-family:Work Sans;font-style:italic;font-display:swap;font-weight:900;src:local("Work Sans Black italic"),local("Work Sans-Blackitalic"),url(/static/work-sans-latin-900italic-8cde70811514c0433d17d98584e72db6.woff2) format("woff2"),url(/static/work-sans-latin-900italic-1a6d02759f7d3a0e842b5b4b80e1889f.woff) format("woff")}@font-face{font-family:Quattrocento Sans;font-style:normal;font-display:swap;font-weight:400;src:local("Quattrocento Sans Regular "),local("Quattrocento Sans-Regular"),url(/static/quattrocento-sans-latin-400-f9042c36d4c29ef78b60ea3b9fc4d8f3.woff2) format("woff2"),url(/static/quattrocento-sans-latin-400-044b97f04108f1c6835c2ecbbc0be210.woff) format("woff")}@font-face{font-family:Quattrocento Sans;font-style:italic;font-display:swap;font-weight:400;src:local("Quattrocento Sans Regular italic"),local("Quattrocento Sans-Regularitalic"),url(/static/quattrocento-sans-latin-400italic-27fc95214d4aa8893f02c7c414cf6bcc.woff2) format("woff2"),url(/static/quattrocento-sans-latin-400italic-40eb9fc5233c8d4b4c8bdade9ea95665.woff) format("woff")}@font-face{font-family:Quattrocento Sans;font-style:normal;font-display:swap;font-weight:700;src:local("Quattrocento Sans Bold "),local("Quattrocento Sans-Bold"),url(/static/quattrocento-sans-latin-700-7f02408bfd734f2f928efa102417383e.woff2) format("woff2"),url(/static/quattrocento-sans-latin-700-a09ad244035860c9c037fde492cbc036.woff) format("woff")}@font-face{font-family:Quattrocento Sans;font-style:italic;font-display:swap;font-weight:700;src:local("Quattrocento Sans Bold italic"),local("Quattrocento Sans-Bolditalic"),url(/static/quattrocento-sans-latin-700italic-9c8ad69a85a974a0d82f648a0acc161e.woff2) format("woff2"),url(/static/quattrocento-sans-latin-700italic-a52268ee293b4b2574ac9110e2f5a369.woff) format("woff")}code[class*=language-],pre[class*=language-]{color:#f8f8f2;background:none;text-shadow:0 1px rgba(0,0,0,.3);font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;border-radius:.3em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#272822}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#8292a2}.token.punctuation{color:#f8f8f2}.token.namespace{opacity:.7}.token.constant,.token.deleted,.token.property,.token.symbol,.token.tag{color:#f92672}.token.boolean,.token.number{color:#ae81ff}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#a6e22e}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url,.token.variable{color:#f8f8f2}.token.atrule,.token.attr-value,.token.class-name,.token.function{color:#e6db74}.token.keyword{color:#66d9ef}.token.important,.token.regex{color:#fd971f}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}pre[class*=language-].line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}pre[class*=language-].line-numbers>code{position:relative;white-space:inherit}.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:0;font-size:100%;left:-3.8em;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-ms-user-select:none;user-select:none}.line-numbers-rows>span{display:block;counter-increment:linenumber}.line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.command-line-prompt{border-right:1px solid #999;display:block;float:left;font-size:100%;letter-spacing:-1px;margin-right:1em;pointer-events:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.command-line-prompt>span:before{color:#999;content:" ";display:block;padding-right:.8em}.command-line-prompt>span[data-user]:before{content:"[" attr(data-user) "@" attr(data-host) "] $"}.command-line-prompt>span[data-user=root]:before{content:"[" attr(data-user) "@" attr(data-host) "] #"}.command-line-prompt>span[data-prompt]:before{content:attr(data-prompt)}body{background-color:#262626}hr{background:#dfdfdf}code[class*=language-],pre[class*=language-]{font-size:.85em}.gatsby-highlight-code-line{background-color:#44463c;display:block;margin-right:-1em;margin-left:-1em;padding-right:1em;padding-left:.75em;border-left:.25em solid #ffec99;line-height:1.75}.gatsby-highlight{border-radius:.3em;margin:.5em 0;padding:1em;overflow:auto}.gatsby-highlight pre[class*=language-]{background-color:transparent;margin:0;padding:0;overflow:initial;float:left;min-width:100%}.gatsby-highlight pre[class*=language-].line-numbers{padding-left:2.8em}ol code[class*=language-text],p code[class*=language-text],ul code[class*=language-text]{color:#e6db74}.command-line-prompt{line-height:2}</style><meta name="generator" content="Gatsby 2.26.1"/><link rel="alternate" type="application/rss+xml" href="/rss.xml"/><link rel="icon" href="/favicon-32x32.png?v=fb715d72022219140fce8e3931088bbf" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><meta name="theme-color" content="#663399"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=fb715d72022219140fce8e3931088bbf"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=fb715d72022219140fce8e3931088bbf"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=fb715d72022219140fce8e3931088bbf"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=fb715d72022219140fce8e3931088bbf"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=fb715d72022219140fce8e3931088bbf"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=fb715d72022219140fce8e3931088bbf"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=fb715d72022219140fce8e3931088bbf"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=fb715d72022219140fce8e3931088bbf"/><title data-react-helmet="true">Testing named exported recursive functions using Jest | WhateverJS Blog</title><meta data-react-helmet="true" name="description" content="In this post I will show you a functional approach approach for testing named exported recursive functions using Jest."/><meta data-react-helmet="true" property="og:title" content="Testing named exported recursive functions using Jest"/><meta data-react-helmet="true" property="og:description" content="In this post I will show you a functional approach approach for testing named exported recursive functions using Jest."/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="Luis C. Ruiz"/><meta data-react-helmet="true" name="twitter:title" content="Testing named exported recursive functions using Jest"/><meta data-react-helmet="true" name="twitter:description" content="In this post I will show you a functional approach approach for testing named exported recursive functions using Jest."/><link as="script" rel="preload" href="/webpack-runtime-525541f8bbf6bfe24cc7.js"/><link as="script" rel="preload" href="/styles-bc72ca78f9bad9fb1f45.js"/><link as="script" rel="preload" href="/framework-5e01c8af6b1735c9eaa3.js"/><link as="script" rel="preload" href="/app-4d770ee9770c5e83aa4d.js"/><link as="script" rel="preload" href="/d5d7a013bc6c1e2b6d7db819052c16d7efea5559-ad37fe78200e2a5bfc11.js"/><link as="script" rel="preload" href="/component---src-templates-blog-post-js-259fbc9e3d11e0527d3f.js"/><link as="fetch" rel="preload" href="/page-data/testing-exported-functions-using-jest/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/414608701.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/63159454.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div style="margin-left:auto;margin-right:auto;max-width:46.4rem;padding:2.175rem 1.0875rem"><header><h3 style="margin-top:0"><a style="box-shadow:none;text-decoration:none;color:inherit" href="/">WhateverJS Blog</a></h3></header><main><article><header><h1 style="margin-top:1.45rem;margin-bottom:0">Testing named exported recursive functions using Jest</h1><p style="font-size:0.87055rem;line-height:1.45rem;display:block;margin-bottom:1.45rem">November 18, 2020<!-- --> - <!-- -->7 min read</p></header><section><p>I’m starting to love Unit Testing, this old good practice adds so much value to any long-term product that I feel it should be mandatory in any software development team. I’ve realized that it increases your confidence as a software developer and helps your teammates to feel more comfortable when they review code because you are showing them what test cases you automated. And, I’m quite sure you will thank yourself in the future whenever you need or want to refactor some code.</p>
<p>In this post I will show you a functional approach approach for testing named exported recursive functions using Jest.</p>
<h3>Prerequisites</h3>
<ol>
<li>Have a good understanding about recursive functions, and how to code them.</li>
<li>Might come handy to read what <a href="https://v2.parceljs.org/" rel="noopener" target="_blank">Jest</a> does, how <a href="https://jestjs.io/docs/en/jest-object#jestspyonobject-methodname" rel="noopener" target="_blank">.spyOn</a> and <a href="https://jestjs.io/docs/en/jest-object#jestfnimplementation" rel="noopener" target="_blank">.fn</a> methods work.</li>
</ol>
<h3>Let’s Do It</h3>
<p>I’m going to present you a real case scenario I faced weeks ago where a request to an API to fetch geographic locations returned a geographic tree. For the sake of simplicity, I’m going to describe a small portion of the response.</p>
<div class="gatsby-highlight" data-language="json"><pre style="counter-reset: linenumber 0" class="language-json line-numbers"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"id"</span><span class="token operator">:</span> <span class="token string">"1"</span><span class="token punctuation">,</span>
  <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Belgium"</span><span class="token punctuation">,</span>
  <span class="token property">"level"</span><span class="token operator">:</span> <span class="token string">"3"</span><span class="token punctuation">,</span>
  <span class="token property">"children"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">"id"</span><span class="token operator">:</span> <span class="token string">"2"</span><span class="token punctuation">,</span>
      <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Brussels"</span><span class="token punctuation">,</span>
      <span class="token property">"level"</span><span class="token operator">:</span> <span class="token string">"2"</span><span class="token punctuation">,</span>
      <span class="token property">"children"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token property">"id"</span><span class="token operator">:</span> <span class="token string">"3"</span><span class="token punctuation">,</span>
          <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Ixelles/Elsene"</span><span class="token punctuation">,</span>
          <span class="token property">"level"</span><span class="token operator">:</span> <span class="token string">"1"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token property">"id"</span><span class="token operator">:</span> <span class="token string">"4"</span><span class="token punctuation">,</span>
          <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Anderlecht"</span><span class="token punctuation">,</span>
          <span class="token property">"level"</span><span class="token operator">:</span> <span class="token string">"1"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token property">"id"</span><span class="token operator">:</span> <span class="token string">"8"</span><span class="token punctuation">,</span>
          <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Jette"</span><span class="token punctuation">,</span>
          <span class="token property">"level"</span><span class="token operator">:</span> <span class="token string">"1"</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token property">"id"</span><span class="token operator">:</span> <span class="token string">"5"</span><span class="token punctuation">,</span>
      <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Antwerpen"</span><span class="token punctuation">,</span>
      <span class="token property">"level"</span><span class="token operator">:</span> <span class="token string">"2"</span><span class="token punctuation">,</span>
      <span class="token property">"children"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token property">"id"</span><span class="token operator">:</span> <span class="token string">"6"</span><span class="token punctuation">,</span>
          <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Geel"</span><span class="token punctuation">,</span>
          <span class="token property">"level"</span><span class="token operator">:</span> <span class="token string">"1"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token property">"id"</span><span class="token operator">:</span> <span class="token string">"7"</span><span class="token punctuation">,</span>
          <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Mechelen"</span><span class="token punctuation">,</span>
          <span class="token property">"level"</span><span class="token operator">:</span> <span class="token string">"1"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token property">"id"</span><span class="token operator">:</span> <span class="token string">"9"</span><span class="token punctuation">,</span>
          <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Sint-Katelijne-Waver"</span><span class="token punctuation">,</span>
          <span class="token property">"level"</span><span class="token operator">:</span> <span class="token string">"1"</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>The response in this case is 3 levels depth. Although the example seems to be simple this could scale to deeper levels, and the data structure could become expensive to manipulate/query/handle if you want to get the very last and deepest level location.</p>
<p>Imagine for example,</p>
<ol>
<li>you need to present this geographical tree as a list where each item has the location’s <code class="language-text">name</code> and its immediate parent’s <code class="language-text">name</code>.</li>
<li>you need to search a location by its name while the user types in an input, and show the matching results inside an autocomplete options list.</li>
<li>you need to build a breadcrumb if the user picks/selects a location. An array where the last element is what the user has selected and the first is the root location (in this case Belgium).</li>
</ol>
<blockquote>
<p>What would be the first thing to do?</p>
</blockquote>
<p>Well, from my perspective you will need a lookup table. It could be a <code class="language-text">Map</code> or an <code class="language-text">Object</code> where keys are the location ids and values are the locations as such.</p>
<p>I’m going to show you the solution I implemented.</p>
<p><strong>1st</strong>, I described the API’s request response using a Typescript interface:</p>
<div class="gatsby-highlight" data-language="typescript"><pre style="counter-reset: linenumber 0" class="language-typescript line-numbers"><code class="language-typescript"><span class="token comment">// Describes the API's response</span>
<span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">GeoTree</span> <span class="token punctuation">{</span>
  id<span class="token operator">:</span> <span class="token builtin">number</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span>
  level<span class="token operator">:</span> <span class="token builtin">number</span>
  children<span class="token operator">?</span><span class="token operator">:</span> GeoTree<span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p><strong>2nd</strong>, I implemented a recursive function that takes the geographical tree as 1st parameter and an instance of a <code class="language-text">Map</code> (optional) as 2nd parameter.</p>
<div class="gatsby-highlight" data-language="typescript"><pre style="counter-reset: linenumber 0" class="language-typescript line-numbers"><code class="language-typescript"><span class="token comment">// Typescript types</span>
<span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">GeoMapElement<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> GeoMapElement<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">>></span></span> <span class="token punctuation">{</span>
  id<span class="token operator">:</span> <span class="token builtin">number</span>
  children<span class="token operator">?</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
  parentId<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">GeoMap<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> GeoMapElement<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">>></span></span> <span class="token operator">=</span> Map<span class="token operator">&lt;</span><span class="token builtin">number</span><span class="token punctuation">,</span> GeoMapElement<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">>></span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token generic-function"><span class="token function">geoTreeToGeoMap</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> GeoMapElement<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">>></span></span></span><span class="token punctuation">(</span>
  geoTreeNode<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">,</span>
  geoMap<span class="token operator">:</span> GeoMap<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map<span class="token operator">&lt;</span><span class="token builtin">number</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token operator">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token operator">:</span> GeoMap<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span> <span class="token punctuation">{</span>
  geoMap<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span>geoTreeNode<span class="token punctuation">.</span>id<span class="token punctuation">,</span> geoTreeNode<span class="token punctuation">)</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>geoTreeNode<span class="token punctuation">.</span>children<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> child <span class="token keyword">of</span> geoTreeNode<span class="token punctuation">.</span>children<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      child<span class="token punctuation">.</span>parentId <span class="token operator">=</span> geoTreeNode<span class="token punctuation">.</span>id
      <span class="token function">geoTreeToGeoMap</span><span class="token punctuation">(</span>child<span class="token punctuation">,</span> geoMap<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> geoMap
<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>Quite simple solution, no? Now, in order test the <code class="language-text">geoTreeToGeoMap</code> function I imported it into a <code class="language-text">spec</code> file.</p>
<div class="gatsby-highlight" data-language="typescript"><pre style="counter-reset: linenumber 0" class="language-typescript line-numbers"><code class="language-typescript"><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">"geoTreeToGeoMap"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token function">it</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">should not add "parentId to root location"</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token comment">// geoTree is the object described in the beginning</span>
    <span class="token keyword">const</span> geoMap <span class="token operator">=</span> <span class="token function">geoTreeToGeoMap</span><span class="token punctuation">(</span>geoTree<span class="token punctuation">)</span>

    <span class="token function">expect</span><span class="token punctuation">(</span>geoMap<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>parentId<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBeUndefined</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token function">it</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">should add "parentId to each location's child"</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> geoMap <span class="token operator">=</span> <span class="token function">geoTreeToGeoMap</span><span class="token punctuation">(</span>geoTree<span class="token punctuation">)</span>

    <span class="token function">expect</span><span class="token punctuation">(</span>geoMap<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>parentId<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>geoMap<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span>parentId<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

    <span class="token function">expect</span><span class="token punctuation">(</span>geoMap<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span>parentId<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>geoMap<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">.</span>parentId<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>No big deal, so far.</p>
<p>After testing the function’s results I decided to make assertions on how many times the function was being called. I thought that using <code class="language-text">jest.fn</code> to wrap the original implementation and use it afterwards was the way to do it.</p>
<div class="gatsby-highlight" data-language="typescript"><pre style="counter-reset: linenumber 0" class="language-typescript line-numbers"><code class="language-typescript"><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">"geoTreeToGeoMap"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token function">afterAll</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    jest<span class="token punctuation">.</span><span class="token function">clearAllMocks</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">"should be called expected times"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> mockFn <span class="token operator">=</span> jest<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span>geoTreeToGeoMap<span class="token punctuation">)</span>

    <span class="token keyword">const</span> geoMap <span class="token operator">=</span> <span class="token function">mockFn</span><span class="token punctuation">(</span>geoTree<span class="token punctuation">)</span>

    <span class="token function">expect</span><span class="token punctuation">(</span>geoMap<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toStrictEqual</span><span class="token punctuation">(</span>geoTree<span class="token punctuation">)</span>

    <span class="token function">expect</span><span class="token punctuation">(</span>mockFn<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveBeenCalledTimes</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>Unfortunately, the test could only track the first function’s call.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/ffabf3a90e1c5fa31237e66a231b6533/cd536/recursive-function-test-failed.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 57.432432432432435%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAABlklEQVQoz32SW3LDIAxFvYQ0ljFgzMt2HNd5NFPvf2u3EkkzTafTjzMSQlwkUNVbi22a8DnP2I5HfIwjPpltGJCOCsO1QVrZrhZxVkiLfpJ/+JFzW1ujIiI4QWs4YyAXhL5HwzHVNtCmZRS0Vahph5B6xOSZgJQD8nDHeVPyK2oaXniEGNGzkHvQdR1yzhi52pwyQogY8oAYE0yvoNwO2hH2+xpvb3vsGWMsqoYFO9uhdyzUOfYdLK9LrPfwTP+4wDnBwXRcdUelaqUaiIZ0arjDIjgeEuZ3rmSMWE4TpjnDB1fWMXtO1Kjr+gnVxDR3y0Ivgi0vjCfYUHMrhC6JT/zAVOLGyVveD/3Hi2Db6tIaUcMVUIEe1I8q/uNF0OkWI4/N6XTCkcdmXVccDgdMHEs5cWwu/rIsZV+sIJ+lFI9K2z4FLU9IJYEcQkmSBOF8PuN6vRZ7uVyK4O12w7ZtxX7vC1KAVCZvK1qVCMgPyiEJeB4hiZXHJ3qxv/mr7UrUNQ+1iIovZX+38hvJkxES5GLJ/ykoOV8YJiIWU99RXQAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Recursive function test failed"
        title="Recursive function test failed"
        src="/static/ffabf3a90e1c5fa31237e66a231b6533/fcda8/recursive-function-test-failed.png"
        srcset="/static/ffabf3a90e1c5fa31237e66a231b6533/12f09/recursive-function-test-failed.png 148w,
/static/ffabf3a90e1c5fa31237e66a231b6533/e4a3f/recursive-function-test-failed.png 295w,
/static/ffabf3a90e1c5fa31237e66a231b6533/fcda8/recursive-function-test-failed.png 590w,
/static/ffabf3a90e1c5fa31237e66a231b6533/efc66/recursive-function-test-failed.png 885w,
/static/ffabf3a90e1c5fa31237e66a231b6533/cd536/recursive-function-test-failed.png 1114w"
        sizes="(max-width: 590px) 100vw, 590px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<p>The reason WHY is failing doesn’t point to Jest but to how named exported functions are transpiled to Javascript.</p>
<div class="gatsby-highlight" data-language="javascript"><pre style="counter-reset: linenumber 0" class="language-javascript line-numbers"><code class="language-javascript"><span class="token string">"use strict"</span>

Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>exports<span class="token punctuation">,</span> <span class="token string">"__esModule"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  value<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
exports<span class="token punctuation">.</span>geoTreeToGeoMap <span class="token operator">=</span> geoTreeToGeoMap

<span class="token keyword">function</span> <span class="token function">geoTreeToGeoMap</span><span class="token punctuation">(</span>geoTreeNode<span class="token punctuation">,</span> geoMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  geoMap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>geoTreeNode<span class="token punctuation">.</span>id<span class="token punctuation">,</span> geoTreeNode<span class="token punctuation">)</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>geoTreeNode<span class="token punctuation">.</span>children<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> child <span class="token keyword">of</span> geoTreeNode<span class="token punctuation">.</span>children<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      child<span class="token punctuation">.</span>parentId <span class="token operator">=</span> geoTreeNode<span class="token punctuation">.</span>id
      <span class="token function">geoTreeToGeoMap</span><span class="token punctuation">(</span>child<span class="token punctuation">,</span> geoMap<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> geoMap
<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>After linking both parts, I understood that spying an exported function that calls itself directly doesn’t reach the function used inside the function’s body because it points to a different memory reference.</p>
<p>To solve this I could take one of the following solutions:</p>
<ol>
<li>declaring an object, assign the function to one of its properties, and use the object’s property reference inside the recursive function, or</li>
<li>importing the recursive function back into its own module and use the imported function inside itself.</li>
</ol>
<p>Both solutions are well described in this <a href="https://stackoverflow.com/questions/45102677/testing-recursive-calls-in-jest" rel="noopener" target="_blank">Stack Overflow question #45102677</a>.</p>
<p>However, I find both solutions had caveats, here are my explanations.</p>
<ol>
<li>The first solution doesn’t play well in a front-end application because export default objects aren’t tree shakable AFAIK.</li>
<li>The second solution produces to my taste a not pleasant code smell. It could be hard to understand WHY a module is importing into itself.</li>
</ol>
<p>Now, here is my solution.</p>
<p>From a Functional Programming perspective the recursive function could be re-written to accept 3 parameters, being the 1st parameter the function used inside the function’s body. Then, a Factory function could be created to bind to the 1st parameter the same recursive function which produces a new function.</p>
<p>The implementation using a Functional Programming approach is as follows:</p>
<p><code class="language-text">geoTreeToGeoMap.types.ts</code></p>
<div class="gatsby-highlight" data-language="typescript"><pre style="counter-reset: linenumber 0" class="language-typescript line-numbers"><code class="language-typescript"><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">GeoMapElement<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> GeoMapElement<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">>></span></span> <span class="token punctuation">{</span>
  id<span class="token operator">:</span> <span class="token builtin">number</span>
  children<span class="token operator">?</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
  parentId<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">GeoMap<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> GeoMapElement<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">>></span></span> <span class="token operator">=</span> Map<span class="token operator">&lt;</span><span class="token builtin">number</span><span class="token punctuation">,</span> GeoMapElement<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">>></span>

<span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">GeoTreeToGeoMapRecursive<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> GeoMapElement<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">>></span></span> <span class="token operator">=</span> <span class="token punctuation">(</span>
  self<span class="token operator">:</span> GeoTreeToGeoMapRecursive<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">,</span>
  geoTreeNode<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">,</span>
  geoMap<span class="token operator">?</span><span class="token operator">:</span> GeoMap<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span>
<span class="token punctuation">)</span> <span class="token operator">=></span> GeoMap<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span>

<span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">GeoTreeToGeoMap</span> <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name">GeoMapElement<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span><span class="token operator">></span><span class="token punctuation">(</span>
  geoTreeNode<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">,</span>
  geoMap<span class="token operator">?</span><span class="token operator">:</span> GeoMap<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span>
<span class="token punctuation">)</span> <span class="token operator">=></span> GeoMap<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token operator">&amp;</span> GeoMapElement<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">>></span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p><code class="language-text">geoTreeToGeoMap.ts</code></p>
<div class="gatsby-highlight" data-language="typescript"><pre style="counter-reset: linenumber 0" class="language-typescript line-numbers"><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{</span>
  GeoMap<span class="token punctuation">,</span>
  GeoMapElement<span class="token punctuation">,</span>
  GeoTreeToGeoMapRecursive<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"./geoTreeToGeoMap.types"</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token generic-function"><span class="token function">geoTreeToGeoMapRecursive</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> GeoMapElement<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">>></span></span></span><span class="token punctuation">(</span>
  self<span class="token operator">:</span> GeoTreeToGeoMapRecursive<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">,</span>
  geoTreeNode<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">,</span>
  geoMap<span class="token operator">:</span> GeoMap<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map<span class="token operator">&lt;</span><span class="token builtin">number</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token operator">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token operator">:</span> GeoMap<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span> <span class="token punctuation">{</span>
  geoMap<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span>geoTreeNode<span class="token punctuation">.</span>id<span class="token punctuation">,</span> geoTreeNode<span class="token punctuation">)</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>geoTreeNode<span class="token punctuation">.</span>children<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> child <span class="token keyword">of</span> geoTreeNode<span class="token punctuation">.</span>children<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      child<span class="token punctuation">.</span>parentId <span class="token operator">=</span> geoTreeNode<span class="token punctuation">.</span>id
      <span class="token function">self</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> child<span class="token punctuation">,</span> geoMap<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> geoMap
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> geoTreeToGeoMapFactory <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name">GeoMapElement<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span><span class="token operator">></span><span class="token punctuation">(</span>
  recursiveFn<span class="token operator">:</span> GeoTreeToGeoMapRecursive<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span>
<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">recursiveFn</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> recursiveFn<span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> geoTreeToGeoMap<span class="token operator">:</span> GeoTreeToGeoMap <span class="token operator">=</span> <span class="token function">geoTreeToGeoMapFactory</span><span class="token punctuation">(</span>
  geoTreeToGeoMapRecursive
<span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>Then, in the <code class="language-text">spec</code> file, the recursive function is wrapped with a jest mock using <code class="language-text">jest.fn</code> and the Factory function uses the mock to produce the <code class="language-text">geoTreeToGeoMap</code>.</p>
<div class="gatsby-highlight" data-language="typescript"><pre style="counter-reset: linenumber 0" class="language-typescript line-numbers"><code class="language-typescript"><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">"function execution"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token function">afterAll</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    jest<span class="token punctuation">.</span><span class="token function">clearAllMocks</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">"should be called expected times"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token comment">// Wrap the recursive implementation with a Spy to keep track of it recursive calls</span>
    <span class="token keyword">const</span> geoTreeToGeoMapRecursiveSpy <span class="token operator">=</span> jest<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span>geoTreeToGeoMapRecursive<span class="token punctuation">)</span>
    <span class="token keyword">const</span> geoTreeToGeoMap<span class="token operator">:</span> GeoTreeToGeoMap <span class="token operator">=</span> <span class="token function">geoTreeToGeoMapFactory</span><span class="token punctuation">(</span>
      geoTreeToGeoMapRecursiveSpy
    <span class="token punctuation">)</span>

    <span class="token keyword">const</span> geoMap <span class="token operator">=</span> <span class="token function">geoTreeToGeoMap</span><span class="token punctuation">(</span>geoTree<span class="token punctuation">)</span>

    <span class="token function">expect</span><span class="token punctuation">(</span>geoMap<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toStrictEqual</span><span class="token punctuation">(</span>geoTree<span class="token punctuation">)</span>

    <span class="token function">expect</span><span class="token punctuation">(</span>geoTreeToGeoMapRecursiveSpy<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveBeenCalledTimes</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>This way the function <code class="language-text">geoTreeToGeoMapRecursiveSpy</code> can be used to make call’s assertions, and the tests passed.</p>
<blockquote>
<p>I hope you liked it.</p>
</blockquote></section><hr style="margin-bottom:1.45rem"/><footer><div style="margin-bottom:3.625rem"><p>Written by <strong>Luis C. Ruiz</strong>. A proactive and disciplined Sr. Software Engineer (Full-stack Web Developer) with rock-solid programming skills in Javascript/Typescript.<a style="text-align:right;display:block" href="https://www.linkedin.com/in/inglkruiz">Read more about me on LinkedIn.</a></p></div></footer></article><nav><ul style="display:flex;flex-wrap:wrap;justify-content:space-between;list-style:none;padding:0;margin-left:0"><li><a rel="prev" href="/apprentices-will-not-understand-typescript/">← <!-- -->Apprentices won&#x27;t understand Typescript, I heard</a></li><li></li></ul></nav></main><footer>© <!-- -->2020<!-- -->, Built with<!-- --> <a href="https://www.gatsbyjs.org">Gatsby</a></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/testing-exported-functions-using-jest/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-a0c9186328768889dad2.js"],"app":["/app-4d770ee9770c5e83aa4d.js"],"component---cache-caches-gatsby-plugin-offline-app-shell-js":["/component---cache-caches-gatsby-plugin-offline-app-shell-js-16703ee5599528db9f93.js"],"component---src-pages-404-js":["/component---src-pages-404-js-167cf145bcc6fba104f5.js"],"component---src-pages-index-js":["/component---src-pages-index-js-24d9c2f5c538a7143d52.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-259fbc9e3d11e0527d3f.js"]};/*]]>*/</script><script src="/polyfill-a0c9186328768889dad2.js" nomodule=""></script><script src="/component---src-templates-blog-post-js-259fbc9e3d11e0527d3f.js" async=""></script><script src="/d5d7a013bc6c1e2b6d7db819052c16d7efea5559-ad37fe78200e2a5bfc11.js" async=""></script><script src="/app-4d770ee9770c5e83aa4d.js" async=""></script><script src="/framework-5e01c8af6b1735c9eaa3.js" async=""></script><script src="/styles-bc72ca78f9bad9fb1f45.js" async=""></script><script src="/webpack-runtime-525541f8bbf6bfe24cc7.js" async=""></script></body></html>